# 🌐 Network Architecture Diagram

## Frontend-Backend Communication Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              DOCKER NETWORK                                 │
│                              (game-network)                                 │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                    ┌───────────────┼───────────────┐
                    │               │               │
            ┌───────▼──────┐ ┌──────▼──────┐ ┌──────▼──────┐
            │   Frontend   │ │   Backend   │ │   External  │
            │   Container  │ │  Container  │ │   Clients   │
            │              │ │             │ │             │
            │ Port: 3000   │ │ Port: 3001  │ │ Port: 3000  │
            │              │ │             │ │ Port: 3001  │
            └──────────────┘ └─────────────┘ └─────────────┘
                    │               │               │
                    └───────────────┼───────────────┘
                                    │
                    ┌───────────────▼───────────────┐
                    │        HOST MACHINE           │
                    │                               │
                    │ localhost:3000 (Frontend)     │
                    │ localhost:3001 (Backend)      │
                    └───────────────────────────────┘
```

## Detailed Communication Flow

### 1. Initial Connection
```
┌─────────────┐   1. HTTP Request    ┌─────────────┐
│  Frontend   │ ───────────────────► │   Backend   │
│ (Port 3000) │                      │ (Port 3001) │
└─────────────┘                      └─────────────┘
        │                                    │
        │   2. Socket.IO Connection          │
        │ ─────────────────────────────────► │
        │                                    │
        │   3. CORS Validation               │
        │ ◄───────────────────────────────── │
```

### 2. Game Communication Flow
```
┌─────────────┐                    ┌─────────────┐
│  Frontend   │                    │   Backend   │
│             │                    │             │
│ 1. join-game│ ─────────────────► │             │
│             │                    │             │
│             │ ◄───────────────── │ 2. joined-  │
│             │                    │    game     │
│             │                    │             │
│ 3. set-     │ ─────────────────► │             │
│    secret   │                    │             │
│             │ ◄───────────────── │ 4. game-    │
│             │                    │   updated   │
│             │                    │             │
│ 5. make-    │ ─────────────────► │             │
│    guess    │                    │             │
│             │ ◄───────────────── │ 6. guess-   │
│             │                    │   made      │
└─────────────┘                    └─────────────┘
```

## Port Mapping

### Development Environment
```
┌─────────────────────────────────────────────────────────────────┐
│                        DOCKER COMPOSE                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Frontend Container:                                            │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ Port Mapping: 3000:3000                                │   │
│  │ Internal: localhost:3000                               │   │
│  │ External: localhost:3000                               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  Backend Container:                                             │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ Port Mapping: 3001:3001                                │   │
│  │ Internal: localhost:3001                               │   │
│  │ External: localhost:3001                               │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Production Environment
```
┌─────────────────────────────────────────────────────────────────┐
│                        PRODUCTION DEPLOYMENT                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Frontend (Netlify):                                            │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ URL: https://your-app.netlify.app                      │   │
│  │ Environment: REACT_APP_SERVER_URL=https://backend.com  │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  Backend (Railway/Render/Heroku):                              │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ URL: https://your-backend.railway.app                  │   │
│  │ Environment: FRONTEND_URL=https://your-app.netlify.app │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## API Endpoints Map

```
┌─────────────────────────────────────────────────────────────────┐
│                        BACKEND API                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  HTTP Endpoints:                                                │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ GET  /health          - Health check                    │   │
│  │ GET  /api/game-status - Game status                     │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  Socket.IO Events:                                             │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ Client → Server:                                       │   │
│  │ • join-game     { gameId, playerName }                 │   │
│  │ • set-secret    { secretNumber }                       │   │
│  │ • make-guess    { targetPlayerId, guess }              │   │
│  │ • restart-game  {}                                     │   │
│  │                                                         │   │
│  │ Server → Client:                                       │   │
│  │ • joined-game    { success, playerId, gameState }      │   │
│  │ • game-updated   { gameState }                         │   │
│  │ • guess-made     { guessData }                         │   │
│  │ • error          { message }                           │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## CORS Configuration

```
┌─────────────────────────────────────────────────────────────────┐
│                        CORS SETUP                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Development:                                                   │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ Origin: "http://localhost:3000"                        │   │
│  │ Methods: ["GET", "POST"]                               │   │
│  │ Credentials: true                                      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  Production:                                                    │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ Origin: [                                               │   │
│  │   "https://your-frontend.netlify.app",                 │   │
│  │   "http://localhost:3000"                              │   │
│  │ ]                                                       │   │
│  │ Methods: ["GET", "POST"]                               │   │
│  │ Credentials: true                                      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## Environment Variables Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    ENVIRONMENT VARIABLES                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Frontend Environment:                                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ NODE_ENV=production                                     │   │
│  │ REACT_APP_SERVER_URL=http://localhost:3001              │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                    │                           │
│                                    ▼                           │
│  Backend Environment:                                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ NODE_ENV=production                                     │   │
│  │ PORT=3001                                               │   │
│  │ FRONTEND_URL=http://localhost:3000                      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## Network Security

```
┌─────────────────────────────────────────────────────────────────┐
│                        SECURITY LAYERS                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. Docker Network Isolation:                                  │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ • Custom bridge network (game-network)                 │   │
│  │ • Container isolation                                   │   │
│  │ • Controlled port exposure                              │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  2. CORS Protection:                                          │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ • Origin validation                                     │   │
│  │ • Method restrictions                                   │   │
│  │ • Credential handling                                   │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  3. Input Validation:                                         │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ • Server-side validation                                │   │
│  │ • Data sanitization                                     │   │
│  │ • Error handling                                        │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

